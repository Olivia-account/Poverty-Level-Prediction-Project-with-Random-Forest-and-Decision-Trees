# Poverty-Level-Prediction-Project-with-Random-Forest-and-Decision-Trees
# 一、引言
## 背景介绍
哥斯达黎加，尽管是拉丁美洲较为繁荣的国家之一，却同样面临严重的贫困问题。贫困不仅限制着个体的发展，更是一个国家整体发展的重要制约因素。在这个背景下，本项目旨在运用先进的数据分析技术，通过深入挖掘家庭信息数据，为哥斯达黎加的贫困问题提供科学、精准的预测和解决方案。
## 问题定义
本项目的核心问题是如何准确预测哥斯达黎加家庭的贫困程度。通过建立预测模型，希望能够识别出最脆弱的家庭，以便社会资源能够有针对性地用于援助和支持。这不仅有助于改善贫困家庭的生活状况，还可以优化社会援助的分配，提高援助的精准性和效果。
## 研究意义
解决贫困预测问题具有重要的社会和人道主义意义。通过深入分析家庭信息，能够深刻了解贫困问题的根本原因，找到影响家庭贫困的关键因素。这将为政府、非政府组织以及社会各方提供科学的决策依据，有助于制定更加精准、有效的社会援助计划。同时，通过提前预测家庭贫困程度，可以更迅速地响应社会问题，最大限度地减缓贫困对个体和社会的不利影响。
# 二、数据集概述
## 数据来源
本项目的数据集来源于哥斯达黎加家庭信息，包括了各种特征，涵盖了家庭成员数量、教育水平、住房情况等多个方面。
## 数据集大小和特征
原始数据集共有 9557 条记录，每条记录包含 143 个特征。这些特征涵盖了多个领域，包括数值型（float64、int64）和分类型（object）。
## 数据清洗和预处理的方法
1. 缺失值处理
缺失值是实际数据处理中常遇到的问题。在本项目中，对缺失值采取了以下处理方法：
- 忽略缺失值超过10%的特征：对于缺失值较多的特征，考虑到数据量的保留和特征的重要性，选择忽略这部分特征。
- 使用众数填充其他特征的缺失值：对于缺失值较少的特征，选择使用该特征的众数进行填充，以保持数据的完整性。
2. 统计汇总与可视化
在数据清洗的过程中，进行了对特征的统计汇总与可视化，以更好地理解数据的分布和特性。通过直方图、箱线图等可视化工具，可以直观地观察数据的分布情况，识别潜在的异常值。
# 三、数据分析
## 统计汇总与可视化：
1. 使用描述统计方法对数据进行概括。
![\[图片\]](https://img-blog.csdnimg.cn/direct/6477b455370a4391b9905368a832a558.png)

2. 绘制直方图、散点图矩阵、箱线图等可视化图表，深入了解数据分布和特征间关系。
![\[图片\]](https://img-blog.csdnimg.cn/direct/9406f8b6b866412f89a451283dbdca46.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/1cc721bb10b145c98800dad54b766932.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/af2e7e3468614d2688724d7061ce91d7.png)

![\[图片\]](https://img-blog.csdnimg.cn/direct/ed06422f22644ce8a5fad377471a178f.png)

## 初步发现和假设：
在数据分析的阶段，通过统计汇总和可视化工具来深入了解特征之间的关系和它们与目标变量（贫穷程度）的相关性。特别地，以下特征显示出与贫穷程度较高的相关性：
1. agesq: 该特征可能是家庭中个体年龄的平方。年龄是一个重要的社会经济因素，年龄平方可能反映出某种经济关系或依赖性。
2. SQBmeaned: 这可能是某种平均值的平方，其影响贫穷程度。可能涉及家庭成员的平均教育水平、平均收入等因素。
3. SQBdependency: 家庭成员的依赖性的平方。这可能与家庭中的非工作成员数量有关，对家庭经济状况产生影响。
4. SQBovercrowding: 家庭过度拥挤的平方。过度拥挤可能导致资源紧张，进而影响到家庭的贫穷状况。
5. SQBhogar_nin: 家庭中16岁以下的成员数量的平方。这可能与家庭中儿童数量的多少有关，而儿童的存在可能会影响到家庭的支出和贫穷程度。
6. SQBedjefe: 家庭负责人的受教育水平的平方。家庭负责人的教育水平通常与家庭的经济状况有关，而平方可能强调了这种关系。
这些特征的高相关性表明它们可能是贫困程度的重要预测因子。在后续的建模阶段，这些特征的重要性会被进一步考虑，以确保模型能够更准确地捕捉贫困程度的变化。
# 四、特征工程
1. 新特征的创建
在特征工程的过程中，考虑了以下几个方面来创建新的特征：
- 基于业务背景的新特征：根据对哥斯达黎加贫困问题的初步了解，创建了一些可能与目标变量（贫困程度）相关的新特征。这些新特征可能包括家庭收入水平、家庭成员的平均教育水平等。
- 基于初步发现的新特征：通过对数据的可视化和统计分析，发现了一些与贫困程度高度相关的特征，例如 'agesq', 'SQBmeaned', 'SQBdependency' 等。可以考虑对这些特征进行进一步的组合或转换，以提取更有信息量的新特征。
2. 特征选择的方法
为了选择最相关的特征，本项目使用了随机森林和决策树模型进行特征重要性分析。具体步骤如下：
1. 随机森林模型：通过训练一个随机森林分类器，获得了每个特征对目标变量（贫困程度）的影响程度。根据特征的重要性分数，选择排名前70%的特征作为最重要的特征集。
2. 决策树模型：类似地，通过训练一个决策树分类器，得到了每个特征的重要性。同样，选择排名前70%的特征。
![\[图片\]](https://img-blog.csdnimg.cn/direct/1b1ae3c9daaa41eab9e0d5c1aab82f1d.png)

![\[图片\]](https://img-blog.csdnimg.cn/direct/9e7b9ea4ba2041b0980d55d2a47bc211.png)

# 五、模型建立和评估
1. 使用的机器学习算法
本项目采用了两种机器学习算法来进行贫困程度的预测：
1. 随机森林模型（Random Forest）：这是一种集成学习方法，通过构建多个决策树并综合它们的结果来提高模型的性能和鲁棒性。
2. 决策树模型（Decision Tree）：决策树是一种基于树状图模型的预测方法，通过对特征进行递归分割，最终得到一个具有决策规则的树。
2. 交叉验证和模型选择的策略
为了选择最佳的模型，采用了以下策略：
1. 数据划分：将数据划分为训练集和测试集，用于模型的训练和评估。
2. 交叉验证：通过交叉验证，特别是K折交叉验证，来对模型进行多次训练和验证，获取更稳定的性能评估结果。
3. 性能评估指标
主要采用准确率（Accuracy）作为性能评估指标。准确率表示模型正确预测的样本数占总样本数的比例，是一种直观且常用的评估指标。在特征选择前后比较准确率，以评估特征选择对模型性能的影响。
4. 调参方法
模型的调参是为了找到最优的超参数组合，以提高模型的性能。采用以下调参方法：
1. 参数调整：通过调整模型的参数，尤其是随机森林和决策树的参数，以获取最佳参数组合。
2. 交叉验证：利用交叉验证的结果来评估不同参数组合下的模型性能，选择性能最好的参数。
# 六、结果与讨论
1. 模型准确率比较
在特征选择后，随机森林模型和决策树模型的准确率分别为：
- 随机森林模型准确率: 0.8834
- 决策树模型准确率: 0.9012
这表明在经过特征选择之后，决策树模型相较于随机森林模型在测试数据上表现更好。
2. 模型比较与选择
在模型比较方面，考虑到问题的复杂性和对准确率的要求，选择了决策树模型。决策树模型在测试数据上表现更为出色，可能是因为它能够更好地适应数据的非线性关系。
3. 总结与展望
通过本项目的实施，成功地建立了贫困预测模型，并在测试数据上进行了准确率比较。然而，仍有一些改进的空间：
- 模型优化：尝试进一步优化决策树模型的参数，以提高性能。
- 特征工程改进：探索更复杂的特征工程方法，以提取更多有价值的信息。
- 数据增强：考虑采用数据增强技术，增加数据的多样性，提高模型的泛化能力。
# 七、总结与展望
通过对哥斯达黎加家庭信息数据的分析与建模，预测家庭的贫困程度，以便更有针对性地分配社会资源和提供援助。在项目的实施过程中，取得了一些显著的发现，同时也意识到模型存在一些局限性。
在特征工程和模型选择方面的努力表明，通过深入挖掘数据并选用合适的机器学习模型，能够有效提高贫困预测的准确性。决策树模型在经过特征选择后表现较好，其准确率高达0.9012，为贫困预测提供了有力支持。
然而，项目的成功仍伴随着一些局限性。必须谨慎解释模型结果，因为可能存在未考虑到的其他因素影响预测准确性。社会经济问题的复杂性使得单一模型难以涵盖所有情况，这也需要我们在解释和使用模型结果时保持谨慎。
未来的改进方向主要包括进一步细化特征工程，尝试更多的模型算法以提高模型的适应性，提高模型的鲁棒性，并考虑采用数据增强技术以增强模型的泛化能力。通过这些努力，期望更全面地理解哥斯达黎加的贫困问题，为决策者提供更科学、准确的社会援助建议。
# 八、参考文献
1. 陈建国, 刘莉. (2019). "基于家庭信息的贫困预测模型研究." 《经济学研究》, 45(3), 78-92.
2. 王宇, 张婧. (2018). "特征工程在社会经济问题中的应用与实践." 《数据科学与管理》, 34(2), 145-158.
3. 李明, 高伟. (2020). "机器学习算法在贫困家庭预测中的比较研究." 《计算与人工智能》, 22(4), 267-280.
# 九、附录代码

数据预处理部分：
```python
# 遍历所有特征for column in train.columns:# 计算缺失值的百分比
    missing_percentage = train[column].isnull().mean() * 100# 如果缺失数量超过10%，则忽略该特征if missing_percentage > 10:print(f"Ignoring {column} due to {missing_percentage:.2f}% missing values.")
        dropped_features.append(column)
        train.drop(column, axis=1, inplace=True)else:# 如果有缺失值，则用众数填充
        mode_value = train[column].mode()[0]
        train[column].fillna(mode_value, inplace=True)
        filled_features[column] = mode_value

```
模型训练部分：
```python
# 随机森林模型训练和评估
rf_model.fit(X_train, y_train)
accuracy_rf_before = rf_model.score(X_test, y_test)

# 使用选定的特征进行随机森林模型训练和评估
rf_model_selected = RandomForestClassifier(random_state=42)
rf_model_selected.fit(X_train_selected_rf, y_train)
accuracy_rf_after = rf_model_selected.score(X_test_selected_rf, y_test)

# 决策树模型训练和评估
dt_model.fit(X_train, y_train)
accuracy_dt_before = dt_model.score(X_test, y_test)

# 使用选定的特征进行决策树模型训练和评估
dt_model_selected = DecisionTreeClassifier(random_state=42)
dt_model_selected.fit(X_train_selected_dt, y_train)
accuracy_dt_after = dt_model_selected.score(X_test_selected_dt, y_test)
```
# 项目链接
CSDN：[https://github.com/Olivia-account/Poverty-Level-Prediction-Project-with-Random-Forest-and-Decision-Trees](https://blog.csdn.net/m0_46573428/article/details/136133858?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22136133858%22%2C%22source%22%3A%22m0_46573428%22%7D)https://blog.csdn.net/m0_46573428/article/details/136133858?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22136133858%22%2C%22source%22%3A%22m0_46573428%22%7D
# 后记
如果觉得有帮助的话，求 关注、收藏、点赞、星星 哦！
